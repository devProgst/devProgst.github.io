<!DOCTYPE html>
<html lang="ru">
	<head>
		<title>Informatics Helper</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
	</head>
	<body>
		<h1>RLE Coding Helper</h1>
		
		<center>
			<textarea rows="10" cols="100" id="RLECOD_inp" placeholder="Введите текст используя таблицу CP1251"></textarea>
			<br>
			<input width="50%" type="button" id="RLECOD_do" value="Выполнить кодирование методом RLE"/>
			<br>
			<input width="50%" type="button" id="RLECOD_8bl" value="Расшифровать двоичный код (8bit-len)"/>
			<br>
			<textarea rows="10" cols="100" id="RLECOD_res" placeholder="Здесь будет сформирована таблица-ответ" readonly></textarea>
		</center>
		
		<script>
			var cp1251table = [ "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", 
								"-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-", "-",
								" ", "!", "\"", "#", "$", "%", "&", "\'", "(", ")", "*", "+", ",", "-", ".", "/",
								"0", "1", "2", "3", "4", "5", "6", "7", "8", "9", ":", ";", "<", "=", ">", "?",
								"@", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O",
								"P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "[", "\\","]", "^", "_",
								"`", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o",
								"p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "{", "|", "}", "~", "DEL",
								"Ђ", "Ѓ", "‚", "ѓ", "„", "…", "†", "‡", "€", "‰", "Љ", "‹", "Њ", "Ќ", "Ћ", "Џ",
								"ђ", "‘", "’", "“", "”", "•", "–", "—", "Не определена", "™", "љ", "›", "њ", "ќ", "ћ", "џ",
								" ", "Ў", "ў", "Ј", "¤", "Ґ", "¦", "§", "Ё", "©", "Є", "«", "¬", "-Ї", "®","Ї",
								"°", "±", "І", "і", "ґ", "µ", "¶", "·", "ё", "№", "є", "»", "ј", "Ѕ", "ѕ", "ї",
								"А", "Б", "В", "Г", "Д", "Е", "Ж", "З", "И", "Й", "К", "Л", "М", "Н", "О", "П",
								"Р", "С", "Т", "У", "Ф", "Х", "Ц", "Ч", "Ш", "Щ", "Ъ", "Ы", "Ь", "Э", "Ю", "Я",
								"а", "б", "в", "г", "д", "е", "ж", "з", "и", "й", "к", "л", "м", "н", "о", "п",
								"р", "с", "т", "у", "ф", "х", "ц", "ч", "ш", "щ", "ъ", "ы", "ь", "э", "ю", "я" ]
			var inp = document.getElementById('RLECOD_inp');
			var but = document.getElementById('RLECOD_do');
			var res = document.getElementById('RLECOD_res');
			var but8 = document.getElementById('RLECOD_8bl');

			function setText(newText) { res.value = newText; }
			function decToTwo(decNum) { 
				if (decNum < 0 || decNum > 255) return -1;
				var twoText = "";
				var twoCoun = 0;
				for(var i = 7; i >= 0; i --) {
					if ( (Math.pow(2, i) + twoCoun) <= decNum ) {
						twoCoun += Math.pow(2, i);
						twoText += "1";
					} else twoText += "0";
				}
				return twoText;
			}
			function twoToDec(twoNum) {
				var twoText = 0;
				for(var i = 0; i < 8; i ++) {
					twoText += Math.pow(2, i) * twoNum[7-i];
				}
				return twoText;
			}
			function twoToSym(twoNum) {
				return cp1251table[twoToDec(twoNum)];
			}
			function symToDec(symBol) {
				for(var i = 0; i <= cp1251table.length; i ++) {
					if (cp1251table[i] == symBol) return i;
				}
				return -1;
			}
			function symToTwo(symBol) { return decToTwo(symToDec(symBol)); }
			but8.onclick = function() {
				var resultConvert = "";
				var twt = "";
				if(inp.value.length % 8 != 0) {
					resultConvert = "Ошибка. Введите 8-битный двоичный код без пробелов";
				} else {
					resultConvert = "";
					for(var i = 0; i < (inp.value.length / 8); i ++) {
						twt = inp.value.substring(8*i, 8*(i+1));
						resultConvert = resultConvert + " " + twt + "\t" + twoToDec(twt) + "\t" + twoToSym(twt) + "\n";
 					}
				}
				setText(resultConvert);
			}
			but.onclick = function() {
				var resultConvert = "";
				var Asym = [];
				var Adec = [];
				var Atwo = [];
				var Azip = [];
				for(var i = 0; i < inp.value.length; i ++) {
					Asym.push(inp.value[i]);
					Adec.push(symToDec(inp.value[i]));
					Atwo.push(symToTwo(inp.value[i]));
				}
				
				
				var i = 1;
				var dStart = 0;
				var dMode = 0;
				var wordlist = "5 ";
				if(Asym[0] == Asym[1]) dMode = 1;
				while(i < inp.value.length-2) {
					if(inp.value[i-1] == inp.value[i] && dMode == 0) {
						worldlist = wordlist + inp.value.substring(dStart, i-2) + "\n";
						dStart = i - 1;
						i = i - 1;
						dMode = 1;
					} 
					else if(inp.value[i-1] != inp.value[i] && dMode == 1) {
						wordlist = wordlist + inp.value.substring(dStart, i) + "\n";
						if(inp.value[i] == inp.value[i+1]) dMode = 1;
						else dMode = 0;
						dStart = i + 1;
					}
					
					i ++;
				}
				setText(" 5 " + wordlist);
				
	
				/* -- while(i < Asym.length-1) {
					if(dMode == 0) {
						if(Asym[i-1] == Asym[i]) { dMode = 1; }
						else if(Asym[i-1] != Asym[i]) { dMode = 2; }
					} else if(dMode == 1) {
						if(Asym[i-1] != Asym[i]) {
							// saveblock (dStart, i-1)
							i -= 2;
							dOne += 1;
							dStart = i;
						}
					} else {
						if(Asym[i-1] == Asym[i]) {
							// saveblock (dStart, i-2)
							i -= 3;
							dTwo += 1;
							dStart = i-1;
						}
					}
					i ++;
					// Azip.push();
				} --*/
				
				for(var i = 0; i < Asym.length; i ++) { 
					resultConvert += Adec[i] + "\t" + Asym[i] + "\t" + Atwo[i] + "\n";
				}
				setText(resultConvert);
			}
		</script>
	</body>
</html>